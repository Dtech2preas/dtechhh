<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üì¶ HTML Hash Viewer</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      max-width: 900px;
      margin: auto;
    }
    textarea {
      width: 100%;
      height: 200px;
      margin-bottom: 1em;
      font-family: monospace;
    }
    iframe {
      width: 100%;
      height: 400px;
      border: 1px solid #aaa;
      margin-top: 1em;
    }
    input#urlBox {
      width: 100%;
      margin-top: 10px;
      padding: 8px;
      font-family: monospace;
    }
    .log {
      background: #111;
      color: #0f0;
      padding: 10px;
      font-family: monospace;
      font-size: 13px;
      margin-top: 1em;
      height: 150px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <h1>üì¶ HTML Link Creator</h1>
  <p>Paste your HTML below and click <b>Generate Link</b>. Your HTML will be encoded into the URL after the <code>#</code>.</p>

  <textarea id="htmlInput" placeholder="Paste your HTML here..."></textarea>
  <button onclick="generateLink()">üîó Generate Link</button>
  <input id="urlBox" readonly placeholder="Your unique URL will appear here">

  <iframe id="preview"></iframe>

  <div class="log" id="debugLog"></div>

  <script>
    const log = (msg) => {
      const el = document.getElementById("debugLog");
      el.textContent += `[${new Date().toLocaleTimeString()}] ${msg}\n`;
      el.scrollTop = el.scrollHeight;
    };

    function generateLink() {
      const html = document.getElementById("htmlInput").value;
      if (!html.trim()) {
        log("‚ùó No HTML provided.");
        return;
      }
      try {
        const encoded = encodeURIComponent(btoa(html));
        const link = location.origin + location.pathname + "#" + encoded;
        document.getElementById("urlBox").value = link;
        log("‚úÖ Link generated.");
        loadPreview(encoded);
      } catch (e) {
        log("‚ùå Encoding error: " + e.message);
      }
    }

    function loadPreview(encoded) {
      try {
        const decoded = atob(decodeURIComponent(encoded));
        const blob = new Blob([decoded], { type: "text/html" });
        const iframe = document.getElementById("preview");
        iframe.src = URL.createObjectURL(blob);
        log("‚úÖ Preview loaded.");
      } catch (e) {
        log("‚ùå Failed to load preview: " + e.message);
      }
    }

    // On page load, check if there's a hash to render
    window.addEventListener("DOMContentLoaded", () => {
      if (location.hash.length > 1) {
        try {
          const encoded = location.hash.substring(1);
          const decoded = atob(decodeURIComponent(encoded));
          document.getElementById("htmlInput").value = decoded;
          log("üì• Loaded HTML from URL hash.");
          loadPreview(encoded);
        } catch (e) {
          log("‚ùå Failed to decode hash: " + e.message);
        }
      } else {
        log("‚ÑπÔ∏è No hash found in URL. Paste some HTML and generate one.");
      }
    });
  </script>
</body>
</html>